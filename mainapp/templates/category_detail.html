{% extends 'base.html' %}
{% load search_filter %}

{% block productfilter %}

      <form class="d-flex mt-3 " action="{% url 'category_detail' slug=category.slug %}" method="GET">
        <input class="form-control me-2" name="search" type="search" placeholder="Поиск товара" aria-label="Search">
        <button class="btn btn-outline-success" type="submit">Поиск</button>
      </form>
    <hr>

    <form action="{% url 'category_detail' slug=category.slug %}" method="GET">
        {{ category|product_spec }}
        <p class="text-center">
            <button class="btn btn-outline-success" type="submit">Поиск</button>
            <button class="btn btn-outline-info" type="submit">Сбросить</button>
        </p>
    </form>
{% endblock productfilter %}


{% block content %}
    <nav aria-label="breadcrumb" class="mt-5">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'base' %}">Главная</a></li>
        <li class="breadcrumb-item"><a href="{{ product.category.get_absolute_url }}">{{ category.name }}</a></li>
      </ol>
    </nav>
<div class="row mt-3">
<div class="col-lg-12 col-md-6 mb-4">
    {% for product in category_products %}
            <div class="card text-center">


                    <div class="card bg-dark text-red">
                          <a href="{{ product.get_absolute_url }}"><img class="card-img" src="{{ product.image.url }}" alt="Card image">
                          <div class="card-img-overlay">
                            <h5 class="card-title">{{ product.title }}</h5>
                            <p class="card-text">Артикул товара: {{ product.vendor_code }}</p>
                            <p class="card-text">Цена за шт: {{ product.price }} р.</p>
                          </div>
                    </div>


                    <div class="card-footer text-muted">

                              <div class="dropdown show ">
                                  <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Просмотреть характеристики
                                      {% if request.user.is_authenticated %}
                                      <a href="{% url 'add_to_cart' slug=product.slug %}">
                                          <button class="btn btn-primary custom ">   В корзину    </button>
                                      </a>
                                      {% else  %}
                                          <a href="{% url 'login' %}">
                                                <button class="btn btn-primary">Авторизоваться</button>
                                          </a>
                                      {% endif  %}
                                  </a>
                                  <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                      {% for f_name, f_value in product.get_features.items %}
                                          <a class="dropdown-item" href="#">{{ f_name }} : {{ f_value }}</a>
                                      {% endfor %}
                                  </div>
                              </div>
              </div>



        {% endfor %}

    </div>

</div>






{% endblock content %}
</div>